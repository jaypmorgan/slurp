<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lisp-style Syntax for R • slurp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Lisp-style Syntax for R">
<meta property="og:description" content="Provides lisp-style sytnax for the R programming language.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">slurp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/data_types.html">02. Data Types</a>
    </li>
    <li>
      <a href="articles/getting_started.html">01. Getting Started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p align="center">
</p>
<p><img src="reference/figures/logo.png"></p>
<em>Statistical Lisp in R</em>

<p>Implemention of Lisp-style sytnax and language design for the <code>R</code> programming language. Code written in SluRp will be translated to <code>R</code> and then executed in that environment.</p>
<p>This project isn’t intended as a production ready application or alternative to <code>R</code> but rather a fun project to learn something about the implementation of lisp and the core <code>R</code> language.</p>
<div id="quick-start-guide" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start-guide" class="anchor"></a>Quick-start Guide</h2>
<p>Start the REPL:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">./slurp</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="ex">SluRp</span><span class="op">&gt;</span></a></code></pre></div>
<p>Or you can run a SluRp script:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="ex">./slurp</span> test.slurp</a></code></pre></div>
<p>In the REPL you can enter the lisp-style commands:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb3-1" title="1">SluRp&gt; (<span class="op">+</span> <span class="dv">2</span> (<span class="op">*</span> <span class="dv">2</span> <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"># [<span class="dv">1</span>] <span class="dv">8</span></a></code></pre></div>
<p>Unlike <code>R</code>, arithmetic functions are applied over all arguments:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb4-1" title="1">SluRp&gt; (<span class="op">+</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">[<span class="dv">1</span>] <span class="dv">15</span></a></code></pre></div>
<p>Create variables using the <code>defparam</code> function. This function returns the value associated with the variable name. These variables can then be references in the same scope.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb5-1" title="1">SluRp&gt; (defparam x <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"># [<span class="dv">1</span>] <span class="dv">5</span></a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5">SluRp&gt; (defparam y <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"># [<span class="dv">1</span>] <span class="dv">10</span></a>
<a class="sourceLine" id="cb5-8" title="8"></a>
<a class="sourceLine" id="cb5-9" title="9">SluRp&gt; (<span class="op">+</span> x y)</a>
<a class="sourceLine" id="cb5-10" title="10"></a>
<a class="sourceLine" id="cb5-11" title="11"># [<span class="dv">1</span>] <span class="dv">15</span></a></code></pre></div>
<p>As its implemented in the <code>R</code> environment, the usual statistical functions are readily available. Here we are taking 10 samples from a normal distribution with the centre and scale of 10. The return of this function is a vector of 10 elements.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb6-1" title="1">SluRp&gt; (rnorm <span class="dv">10</span> <span class="dv">10</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"># [<span class="dv">1</span>]  <span class="fl">14.8692128</span>   <span class="fl">3.4932029</span>  <span class="fl">18.6337963</span>  <span class="fl">15.5319696</span>  <span class="fl">-2.9426000</span> <span class="fl">-11.6523209</span></a>
<a class="sourceLine" id="cb6-4" title="4"># [<span class="dv">7</span>]  <span class="fl">-0.9475137</span>   <span class="fl">6.1512033</span>   <span class="fl">4.6517305</span>   <span class="fl">8.0993424</span></a></code></pre></div>
<p>Function arguments can be supplied using the <code>:keyword</code> form. For example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb7-1" title="1">SluRp&gt; (rnorm <span class="dv">10</span> :mean <span class="dv">10</span> :sd <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"> [<span class="dv">1</span>] <span class="fl">10.306800</span> <span class="fl">11.189320</span> <span class="fl">10.914911</span> <span class="fl">10.141386</span> <span class="fl">11.459372</span>  <span class="fl">9.440626</span> <span class="fl">10.889350</span></a>
<a class="sourceLine" id="cb7-3" title="3"> [<span class="dv">8</span>]  <span class="fl">9.807462</span> <span class="fl">11.059608</span> <span class="fl">10.595251</span></a></code></pre></div>
<p>In this example, we are once again calling the <code>rnorm</code> function and taking 10 samples from a normal distribution. But instead of supplying the arguments by the position they occur in the function call (number of samples, mean, and then standard deviation of the distribution), we are using keywords. When this form is evaluated in <code>R</code> this gets translated to:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>As opposed to <code>R</code> base, most functions return a value. Take for example the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> function in <code>R</code> that prints the passed argument to the stream output. In SluRp, the argument that is passed to the function is printed to the stream and also returned.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb9-1" title="1">SluRp&gt; (<span class="kw">print</span> <span class="st">"testing"</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">[<span class="dv">1</span>] <span class="st">"testing"</span></a>
<a class="sourceLine" id="cb9-3" title="3">[<span class="dv">1</span>] <span class="st">"testing"</span></a></code></pre></div>
<div id="data-types" class="section level3">
<h3 class="hasAnchor">
<a href="#data-types" class="anchor"></a>Data types</h3>
<p>Lisp is a list processor, but we’re working with <code>R</code>, so we have access to more complex data-types. One of which is the vector or <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> data-type for simple storage and vector arithmetic. We can create a vector with squared-brackets, e.g. <code>[1 2 3]</code> is translated to <code><a href="https://rdrr.io/r/base/c.html">c(1, 2, 3)</a></code>. This translation is necessary for when we’re using functions that expect vector arguments:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb10-1" title="1">SluRp&gt; (mean [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span>])</a>
<a class="sourceLine" id="cb10-2" title="2">[<span class="dv">1</span>] <span class="dv">3</span></a></code></pre></div>
</div>
<div id="creating-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-functions" class="anchor"></a>Creating functions</h3>
<p>Anonymous functions can be created using a <code>lambda</code> expression. Take for example applying a function to a map (from the <code>purrr</code> package).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb11-1" title="1">SluRp&gt; (library purrr)</a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3">SluRp&gt; (<span class="kw">map</span> [<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>] (<span class="kw">lambda</span> (x) (<span class="op">*</span> x <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb11-4" title="4">[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb11-5" title="5">[<span class="dv">1</span>] <span class="dv">2</span></a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7">[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb11-8" title="8">[<span class="dv">1</span>] <span class="dv">4</span></a>
<a class="sourceLine" id="cb11-9" title="9"></a>
<a class="sourceLine" id="cb11-10" title="10">[[<span class="dv">3</span>]]</a>
<a class="sourceLine" id="cb11-11" title="11">[<span class="dv">1</span>] <span class="dv">6</span></a></code></pre></div>
<p>Anonymous functions can also be bound to a name. This is perhaps just a longer way of creating a function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb12-1" title="1">SluRp&gt; (defparam print_name (<span class="kw">lambda</span> (name) (<span class="kw">print</span> (paste <span class="st">"Hello, "</span> name))))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">function</span> (name)</a>
<a class="sourceLine" id="cb12-3" title="3">{</a>
<a class="sourceLine" id="cb12-4" title="4">    <span class="kw">print</span>(paste(<span class="st">"Hello, "</span>, name))</a>
<a class="sourceLine" id="cb12-5" title="5">}</a>
<a class="sourceLine" id="cb12-6" title="6">SluRp&gt; (print_name <span class="st">"SluRp"</span>)</a>
<a class="sourceLine" id="cb12-7" title="7">[<span class="dv">1</span>] <span class="st">"Hello,  SluRp"</span>  # value is printed to <span class="kw">stream</span></a>
<a class="sourceLine" id="cb12-8" title="8">[<span class="dv">1</span>] <span class="st">"Hello,  SluRp"</span>  # value is also returned</a></code></pre></div>
<p>The shorter way to create a normal function is to use the <code>defun</code> function. The arguments to <code>defun</code> are the parameters of the function (or an optional empty list) and the body of the function i.e. what happens when the function is called.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb13-1" title="1">SluRp&gt; (<span class="kw">defun</span><span class="fu"> add </span>(x y) (<span class="op">+</span> x y))</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">function</span> (x, y)</a>
<a class="sourceLine" id="cb13-3" title="3">{</a>
<a class="sourceLine" id="cb13-4" title="4">    x <span class="op">+</span> y</a>
<a class="sourceLine" id="cb13-5" title="5">}</a>
<a class="sourceLine" id="cb13-6" title="6">SluRp&gt; (add <span class="dv">1</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-7" title="7">[<span class="dv">1</span>] <span class="dv">3</span></a></code></pre></div>
</div>
</div>
<div id="language-lasagnes" class="section level2">
<h2 class="hasAnchor">
<a href="#language-lasagnes" class="anchor"></a>Language Lasagnes</h2>
<p>What programming stack do you use? Answer: all of them:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode lisp"><code class="sourceCode commonlisp"><a class="sourceLine" id="cb14-1" title="1"><span class="co">;; use slurp to talk to R, to talk to python, to talk to c/c++</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">;; use reticulate to talk to python</span></a>
<a class="sourceLine" id="cb14-3" title="3">(library reticulate)</a>
<a class="sourceLine" id="cb14-4" title="4"></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">;; import numpy as torch which should be implemented in C/C++</span></a>
<a class="sourceLine" id="cb14-6" title="6">(defparam np (<span class="kw">import</span> <span class="st">"numpy"</span>))</a>
<a class="sourceLine" id="cb14-7" title="7">(defparam torch (<span class="kw">import</span> <span class="st">"torch"</span>))</a>
<a class="sourceLine" id="cb14-8" title="8">(defparam nn (<span class="kw">import</span> <span class="st">"torch.nn"</span>))</a>
<a class="sourceLine" id="cb14-9" title="9"></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">;; define a simple feedforward network as a test</span></a>
<a class="sourceLine" id="cb14-11" title="11">(defparam model</a>
<a class="sourceLine" id="cb14-12" title="12">  (nn$Sequential (nn$Linear :in_features 4L :out_features 10L)</a>
<a class="sourceLine" id="cb14-13" title="13">                 (nn$ReLU)</a>
<a class="sourceLine" id="cb14-14" title="14">                 (nn$Linear :in_features 10L :out_features 3L)</a>
<a class="sourceLine" id="cb14-15" title="15">                 (nn$Softmax)))</a>
<a class="sourceLine" id="cb14-16" title="16"></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">;; Use the existing iris dataset from R</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">;; create a matrix of all the input features</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="co">;; convert to a numpy array and then a torch tensor</span></a>
<a class="sourceLine" id="cb14-20" title="20">(<span class="kw">defun</span><span class="fu"> get-data </span>()</a>
<a class="sourceLine" id="cb14-21" title="21">  (torch$FloatTensor</a>
<a class="sourceLine" id="cb14-22" title="22">    (np$array</a>
<a class="sourceLine" id="cb14-23" title="23">      (as.matrix (select iris [Sepal.Width, Sepal.Length, Petal.Width, Petal.Length])))))</a>
<a class="sourceLine" id="cb14-24" title="24"></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="co">;; create class predictions (as the model isn't trained, these are just random predictions)</span></a>
<a class="sourceLine" id="cb14-26" title="26">(defparam preds (model get-data))</a>
<a class="sourceLine" id="cb14-27" title="27"></a>
<a class="sourceLine" id="cb14-28" title="28"><span class="co">;; print the predictions to stdout</span></a>
<a class="sourceLine" id="cb14-29" title="29">(<span class="kw">print</span> preds)</a></code></pre></div>
</div>
<div id="things-to-do" class="section level2">
<h2 class="hasAnchor">
<a href="#things-to-do" class="anchor"></a>Things to do:</h2>
<ul>
<li>[X] Lisp tokenisation</li>
<li>[X] Basic function application</li>
<li>[X] Vector notation</li>
<li>[X] Nested function application</li>
<li>[X] Function definitions</li>
<li>[X] Lambdas</li>
<li>[X] Variable assignments</li>
<li>[ ] Sets and Lists</li>
<li>[X] Keyword arguments</li>
<li>[ ] Macros</li>
<li>[ ] Pre-installed macros such as threading</li>
</ul>
<div id="functions-to-implement" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-to-implement" class="anchor"></a>Functions to implement</h3>
<ul>
<li>[ ] Cons</li>
<li>[ ] Listp</li>
<li>[ ] Atomp</li>
<li>[ ] Better evaluation - special symbols evaluate to themselves</li>
<li>[ ] Better tokenisation – should take into account the end of the list to allow scripts to run</li>
<li>[ ] Quote/Eval</li>
</ul>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>use_mit_license()</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jay Morgan <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3719-362X" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jay Morgan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
